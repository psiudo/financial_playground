<!-- back/docs/알림 및 메시지 시나리오.md -->
## ✅ 알림 및 메시지 흐름

**[목표]** 사용자는 자신의 활동이나 시스템 변화에 대한 알림을 받아, 실시간 반응과 빠른 액션을 수행할 수 있어야 한다.

---

### 시나리오

#### 1. 알림 수신 구조

1. 사용자는 로그인 상태에서 플랫폼을 이용한다.
2. 시스템은 다음 이벤트 발생 시 알림을 생성한다:
   - 매수/매도 거래 완료
   - 금융상품 가입 완료
   - 알고리즘 전략 실행 종료
   - 커뮤니티 반응 (댓글, 좋아요, 답글)
   - 시스템 공지 (서비스 점검, 정책 변경 등)
3. 생성된 알림은 다음 방식으로 표시된다:
   - 헤더 영역의 알림 아이콘에 숫자 배지
   - 클릭 시 알림 리스트 드롭다운 표시 (최신순 정렬)
   - 주요 알림은 화면 하단 우측에 실시간 팝업 토스트로도 표시됨

#### 2. 알림 리스트 기능

4. 사용자가 알림 아이콘을 클릭하면, 최근 알림 리스트가 드롭다운으로 열림
5. 각 알림 항목은 다음 정보를 포함한다:
   - 아이콘 (종류별: 거래, 커뮤니티, 전략 등)
   - 알림 요약 문구 (예: “삼성전자 5주 매수 완료”)
   - 타임스탬프 (예: “2시간 전”)
6. 알림 클릭 시 해당 기능으로 직접 이동:
   - 매수 알림 → 포트폴리오 상세
   - 댓글 알림 → 해당 게시글로
   - 전략 실행 알림 → 전략 상세
7. ‘전체 알림 보기’ 클릭 시 알림 페이지로 이동
   - 읽음/안 읽음 상태 확인
   - 전체 읽음 처리, 개별 삭제 가능

#### 3. 알림 세부 페이지 기능

8. 사용자별 알림은 DB에 저장되며, 다음 정보를 가짐:
   - 알림 ID, 사용자 ID, 유형, 메시지, 링크, 생성 시각, 읽음 여부
9. 사용자 설정에서 알림 종류별 수신 여부 설정 가능:
   - 모든 알림 허용 / 중요 알림만 / 수신 거부
10. 시스템 공지(필수 알림)는 수신 거부 불가

---

### 조건 분기 정리

| 조건 | 처리 방식 |
|------|------------|
| 미로그인 | 알림 표시 없음 |
| 실시간 반응 필요 | 팝업 토스트 + 헤더 배지 표시 |
| 클릭 시 이동 대상 없음 | 기본 경고 메시지 (“대상이 삭제되었습니다”) |
| 사용자 알림 비활성화 | 해당 유형 알림 생성하지 않음 |

---

### UX 흐름 요약

\[사용자 활동 or 시스템 이벤트 발생\]  
    ↓  
\[알림 생성 → 헤더 알림 아이콘 + 팝업 표시\]  
    ↓  
\[알림 클릭 → 관련 기능으로 이동\]  
    ↓  
\[전체 보기 페이지 → 알림 목록 관리 (읽음/삭제/설정)\]

---

### 보완 요소 (심화 설계 가능)

- 알림 종류별 색상/아이콘 차등 표시
- 알림 읽음 상태 동기화 (디바이스 간)
- 비동기 WebSocket 기반 실시간 알림 푸시
- 사용자별 ‘내 알림 로그’ 다운로드 기능 (.csv)
